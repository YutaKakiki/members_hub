# はじめに

この度、[Members Hub](https://members-hub.onrender.com/)　というWebアプリを開発しました。

サークルや部活などの「チーム」を対象として、メンバーのプロフィールを検索して閲覧できるプラットフォームを提供するためのサービスとなっています。

開発の記録として、この記事を残すことにします。


![linkedin_banner_image_1.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/af9815af-1596-12bd-9c67-4c8b41d2ac98.png)

---

### サービスURL
https://members-hub.onrender.com/

※Renderの無料枠でデプロイしています。そのため、サイトの立ち上がりに20〜30秒かかる可能性があります。



### <font color="gree">30人のBotを登録した「サンプルチーム」に参加することでMembers Hubを体験していただけます！</span>

 SNSまたはメールでアカウントを作成してログインしていただいた後、
 「チームに参加する」⇨ チームIDに``419a31d3-90e0-4bea-b3d1-bf4b38298654``、パスワードに``sampleteam``を入力して、チームに参加してみてください。プロフィール項目の設定は適当で大丈夫です！
[![Image from Gyazo](https://i.gyazo.com/f0913bbd33e4ffc09fbe5aecb4a9820a.png)](https://gyazo.com/f0913bbd33e4ffc09fbe5aecb4a9820a)


### <font color="gree">登録不要でサンプルユーザーとしてもログインいただけます！</span>

 メールアドレスに``sample@sample.com``、パスワードに``password``を入力してログインしてみてください！
 同じく、サンプルチームを閲覧することができます。
[![Image from Gyazo](https://i.gyazo.com/ef58a808007e8a4c8ae0337676b817bd.png)](https://gyazo.com/ef58a808007e8a4c8ae0337676b817bd)


# 目次

[1. 開発した背景](#1-開発した背景) <br>
[2. 機能一覧](#2-機能一覧) <br>
[3. アーキテクチャ](#3-アーキテクチャ)<br>
[4. 使用技術](#4-使用技術) <br>

# 1. 開発した背景

#### ・　所属していたサークルの「自己紹介カード」というシステム
自分の所属していたサークルでは、毎年５月あたり（新入生がサークルに入会するタイミング）で「自己紹介カード」というシステムがありました（システムといえばおかしいかな？）。
「自己紹介カード」には以下のようなフローがありました。

1. 総務班長（役職）が、Wordファイルのフォーマットを用意・配布
2. サークルのメンバーがそれぞれ書き込んで総務班長に提出（LINEで）
3. 総務班長が集計し、パート（ダンスのサークルだったのでパートで別れていました）や代に分けて、ファイルを繋ぎ合わせたものを画像orPDF化
4. OneCloudにアップロード

このフローの中には以下のような非効率的な問題点があると感じていました。

**❶総務班長の負担**
**❷集計にかかる時間**
**❸(メンバーから見て)閲覧時の利便性**

**❶に関して**、フォーマットを代々引き継いでいるものかとは思いますが、フォーマットを新しくしたくなった場合などは作り直したりすることを考えると面倒です。それに、Wordファイルで作られたフォーマットはとても書きにくいと感じていました。入力が長ければフォーマットが崩れたりするし、間違えてフォーマットを破壊する可能性もありました。

**❷に関して**、サークルのメンバーたちはこの「自己紹介カード」の開示を結構楽しみにしていました笑。しかし、総務班長はフローにあげたように面倒なことをしなければならず、人によって自己紹介カードを提出するタイミングもまちまちです。全員の分が揃わないと公開できなかったので、時間がかかったのです。

❸に関して、これを感じていたのは自分だけかもしれませんが、「検索できたらな」と感じることがありました。プロフィールを流し読みするならこのままでもいいかもしれません。しかし、例えば、１回生がサークルに入ってきたとして「同じパートで〇〇学部」や「同じ出身地」の友達いるかな..?って気持ちで探していたとします。そうすると、すべてのカード（多ければ150人分）をくまなく探す必要があったのです。そこで、「検索したらでてくる」といいなぁと感じていました。

### ❶❷❸の課題をすべて解決するのがMembers Hub
上の課題を解決すべく、機能の構想から始め、開発に着手しました。次のセクションで機能について述べていくので、機能を紹介した後で、またこれらの課題に触れ、いかなる形で解決しているのかをまとめます。

# 2. 機能一覧
ホームページをご覧いただいても良いのですが、Members Hubを使う上で踏むべきステップがあるので、ステップごとに紹介していきます。
はじめに、早速ステップからは外れますが（笑）ログイン機能などの認証周りから述べていきます。

※以下は、PC画面となっています
### 新規登録/ログイン
[![Image from Gyazo](https://i.gyazo.com/8d507f479365dc34abce05a7af8eda06.png)](https://gyazo.com/8d507f479365dc34abce05a7af8eda06)
[![Image from Gyazo](https://i.gyazo.com/e63b59cf3740aece27afc19dca46c819.jpg)](https://gyazo.com/e63b59cf3740aece27afc19dca46c819)

メールアドレスによる登録はもちろん、Google/LINEによログインが可能です。

### チームを作成する
[![Image from Gyazo](https://i.gyazo.com/8ee517f7010580c039ec9d712496bd14.jpg)](https://gyazo.com/8ee517f7010580c039ec9d712496bd14)
サイドバーの「チームを作成」から、「チーム名」「パスワード」「ロゴ画像」を指定して、次へを押します。

### チームのプロフィール項目を設定する

![a6b826182b732063e72c223648861f11.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/c2854002-942e-37b6-77f1-fe271f9d2de1.gif)

上のステップで「次へ」を押すと、このページに遷移します。デフォルトでは名前、生年月日、プロフィール画像が項目として設定されており、削除することはできません。
チームごとに追加で7つ設定でき、設定中に項目名の編集・削除もできます。
なお、この項目は後からでも編集可能です。
項目の登録後、チームの作成が完了し、作成したユーザーが「チームの管理者」となります。

### チームにメンバーを招待する

管理者権限で、招待リンクを生成することができます。有効期限は24時間以内です。期限が切れた場合はまた生成することができます。このリンクはワンクリックでコピーできます。
[![Image from Gyazo](https://i.gyazo.com/6c1af9f71730992e8fca5024402c919b.png)](https://gyazo.com/6c1af9f71730992e8fca5024402c919b)
以下のような文章がコピーされ、LINEなどに管理者が共有する想定です。
>以下のリンクから チーム七福神 に参加しましょう！
>    
>👉 http://localhost:3000/teams/invitation?team_id=dc08daa5-f2dd-4582-b9a3->3>8da8229c8f1&token=CeQ-b93xWVYpH753G0470g
>チームID・パスワードによる認証なしで簡単に参加することができます。
 Members Hub に登録/ログインしていない場合は、登録/ログイン後にチームへの認証が完了します。
>⚠️この招待リンクの有効期限は2024/09/17 13:20です。期限を過ぎたリンクは無効となりますのでご注意ください。

### ユーザーがチームに参加する

ユーザーがチームに参加する方法は2通りあります。

**①チームID・パスワードを入力する**

チームには、自動でIDが付与されています。

[![Image from Gyazo](https://i.gyazo.com/9bb82fd575c57c9389e0cd78fd7c95d0.png)](https://gyazo.com/9bb82fd575c57c9389e0cd78fd7c95d0)
これを、「チームに参加」画面にてチームIDとして入力し、管理者によってチーム作成時に設定されたチームパスワードを入力することでチームへの認証に成功し、プロフィールの登録画面に遷移します。

**②管理者が発行した招待リンクを踏む**

リンクを踏んだユーザーは、ログインしていれば即座に認証が成功し、ログイン/新規登録をしていない場合はその後に自動的に認証に成功するようになっています。

今回は、上のステップで生成した招待リンクをそのままアドレスバーに打ち込んでいます。

![30638fb855915d207e68de1184b451d7.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/439c0dbe-cbf3-b015-32a1-aceec1b9c673.gif)


### プロフィールを登録する
チームの認証に成功すると、プロフィール登録画面に遷移するので、すべての項目に記入の上、「登録」ボタンを押すと、チームへの参加が完了します。
![dbcdef4265225206f230ab5848dd51d2.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/8c3f3b2e-7ea7-e936-8efc-aee551105400.gif)
なお、プロフィールを登録せずに別のページに遷移した場合（ユーザーが別のページへ移った場合）は、チームへの参加がキャンセルされます。

### チームメンバーを閲覧する/検索する
「メンバーを閲覧」をクリックすると、参加しているチーム名が出てくるので、閲覧したい方をクリックします。
先ほど作成した「チーム七福神」も見えますね。ただ、今回はBotを登録している「サンプルチーム」の方を見ていきます。
![cde336971d898ac7fb699627ef916bba.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/71cae2f8-604e-07db-8557-555b9fd61a90.gif)
プロフィール項目を選んで、キーワードを入力すると、合致したメンバーがでてくるようになっています。
項目を増やしてAND検索で条件を絞ることも可能ですし、キーワードに「、」を含めることでOR検索も行われるようになっています。 AND検索とOR検索は、幾つでも指定可能です。

![8624ea874fad1394a8e11fdac4a0f252.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/5f57b8ea-9b98-cf96-f7a7-dd1b5a55f75e.gif)

----
### その他 

### チームのプロフィール項目の更新 / メンバー自身のプロフィールの更新
プロフィール項目を削除/項目名の編集が可能です。ただし、既にメンバーが登録している状態で項目の削除を行うと、メンバーの項目名に対応するプロフィールのデータも削除されます。
既にメンバーが登録している状態で新たにプロフィール項目を追加した際は、各メンバーの「プロフィールを編集」ページに新たに記入フォームが追加されるようになっています。

![fc13ba5fc60b618576b665cefb60affa.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/8d877498-115a-4e2c-5d42-f05fe70fe8fb.gif)


### 管理者権限の譲渡
管理者は、チーム情報の更新/チーのプロフィール項目の編集/招待リンクの発行/チームの削除が可能です。管理者は、管理権限を別のメンバーに譲渡することができます。
権限を譲渡した後は、「管理中のチーム」からサンプルチームが消えていることがわかります。

![5a55b25eaa2c122dbf8ceabb9cfbe105.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/393fd1c4-e688-ae35-5db3-534f29c6bbd8.gif)

----
### Members Hubによる課題へのアプローチ


前セクションで述べた❶❷❸の課題がサービスによって解決できている（はず）ことが伝わったでしょうか。

❶の総務班長の負担に関しては、「チームを作成→項目を登録→招待リンクを共有」の３ステップで済むようになりました。1つ1つのステップも簡単に行えます。フォーマットも用意する必要がなく、（凝ったデザインではありませんが）Members Hubが整ったフォーマットでうまく表示してくれます。

❷の集計時間に関しては、そもそも集計する必要がなくなりました。プロフィールを登録して参加した時点で、すでに参加しているメンバーのプロフィールを閲覧できるようになりました。

❸の閲覧の利便性ですが、こちらも「検索フォーム」ができたことによって簡単にメンバーを探し出せるようになりました。

初めは、自身のサークル専用に作る予定でしたが、プロフィール項目を自由に設定できるようにしたことで、どのチームでも使える設計にしました。前回は「あったら面白いな」の理想ドリブンでしたが、課題ドリブンな開発はなんとなくやりがいを感じていました。

とは言いつつ、今のところ実用化を考えていません...（運用してFBを貰ってこその開発だろ！！なんですけど、他にもやりたいことがたくさんありまして...）。でも今後、このサービスが最も必要とされそうな４〜５月あたりにリリースするはのいいかもしれないですね。


# 3. アーキテクチャ

### アーキテクチャ図

以下のように表せるかと思います。
バックエンド＋フロントエンドはRailsですべて書いています。もっと詳しく言えば、フロントエンドはERBがメインで、JSはほとんど書かず、[Hotwire](https://hotwired.dev/)(Turbo,Stimulus)が動いています。

![developper (2).png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/2e08e4b2-99c6-68c7-faa0-f810ebc9ae62.png)


### ER図


![5D8D1C6F-665B-402C-856A-27BBDFABAD7F_1_201_a.jpeg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3657525/f13410d0-91f7-6a60-18ce-0f464af96fbb.jpeg)


# 4. 使用技術

|カテゴリー|使用技術| 
|:--|:--|
|バックエンド|Ruby 3.3.4 <br> Rails 7.1.3.4|
|データベース|PostgreSQL|
|クラウドストレージ|Amazon S3|
|認証|Devise <br> OmniAuth(Google,LINE)<br>|
|フロントエンド|ERB <br> TailwindCSS <br> Hotwire <br> tailwindcss-stimulus-components<br> JavaScript <br> FontAwesome<br>
|デプロイ|Render|
|開発環境|Docker <br> Docker Compose|
|テスティングフレームワーク|Rspec 6.1.0|
|静的コード解析|Rubocop|
